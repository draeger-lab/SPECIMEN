<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>specimen.core.refinement package &mdash; SPECIMEN 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=559046d4" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/custom_theme.css?v=0eca129c" />

  
    <link rel="shortcut icon" href="_static/LogoSPECIMEN.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=8d563738"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=7859de39"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="specimen.util package" href="specimen.util.html" />
    <link rel="prev" title="specimen.core package" href="specimen.core.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/LogoSPECIMEN.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="about-pipeline.html">About the SPECIMEN</a></li>
<li class="toctree-l1"><a class="reference internal" href="run-pipeline.html">Run the Pipeline</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="specimen.html">Contents of SPECIMEN</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="specimen.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="specimen.classes.html">specimen.classes package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="specimen.core.html">specimen.core package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="specimen.core.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="specimen.core.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="specimen.core.html#module-specimen.core.analysis">specimen.core.analysis module</a></li>
<li class="toctree-l4"><a class="reference internal" href="specimen.core.html#module-specimen.core.bidirectional_blast">specimen.core.bidirectional_blast module</a></li>
<li class="toctree-l4"><a class="reference internal" href="specimen.core.html#module-specimen.core.generate_draft_model">specimen.core.generate_draft_model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="specimen.core.html#module-specimen.core.validation">specimen.core.validation module</a></li>
<li class="toctree-l4"><a class="reference internal" href="specimen.core.html#module-specimen.core">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="specimen.util.html">specimen.util package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="specimen.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="specimen.html#module-specimen.cmd_access">specimen.cmd_access module</a></li>
<li class="toctree-l2"><a class="reference internal" href="specimen.html#module-specimen.workflow">specimen.workflow module</a></li>
<li class="toctree-l2"><a class="reference internal" href="specimen.html#module-specimen">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="help.html">Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-notes.html">Notes for Developers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SPECIMEN</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="specimen.html">Contents of SPECIMEN</a></li>
          <li class="breadcrumb-item"><a href="specimen.core.html">specimen.core package</a></li>
      <li class="breadcrumb-item active">specimen.core.refinement package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/specimen.core.refinement.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="specimen-core-refinement-package">
<h1>specimen.core.refinement package<a class="headerlink" href="#specimen-core-refinement-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-specimen.core.refinement.annotation">
<span id="specimen-core-refinement-annotation-module"></span><h2>specimen.core.refinement.annotation module<a class="headerlink" href="#module-specimen.core.refinement.annotation" title="Link to this heading"></a></h2>
<p>Further annotate a model.</p>
<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.annotation.kegg_reaction_to_kegg_pathway">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.annotation.</span></span><span class="sig-name descname"><span class="pre">kegg_reaction_to_kegg_pathway</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viaEC</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viaRC</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specimen.core.refinement.annotation.kegg_reaction_to_kegg_pathway" title="Link to this definition"></a></dt>
<dd><p>Retrieve the KEGG pathways for existing KEGG reaction IDs, if
they have yet to be added. Depending on the given options, only the
reactions is searched or additional searches are started using the
EC number and reactions class if the first search was unsuccesful.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>model (cobra.Model): The model - loaded with COBRApy - to be annotated.</p></li>
<li><dl class="simple">
<dt>viaEC (bool, optional): Option to search for KEGG pathway ID </dt><dd><p>using the EC number if previous searches were unsuccesful. 
Defaults to False.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>viaRC (bool, optional): Option to search for KEGG pathway ID </dt><dd><p>using the reaction class if previous searches were unsuccesful. 
Defaults to False.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.annotation.run">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.annotation.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kegg_viaEC</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kegg_viaRC</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memote</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specimen.core.refinement.annotation.run" title="Link to this definition"></a></dt>
<dd><p>Further annotate a given model.</p>
<p>Currently can add annotations for:
- SBO using SBOannotator
- KEGG.reaction -&gt; KEGG.pathway</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>model (str): Path to the model.</p></li>
<li><p>dir (str): Path to the output directory.</p></li>
<li><dl class="simple">
<dt>kegg_viaEC (bool, optional):  Option to search for KEGG pathway ID using the </dt><dd><p>EC number if previous searches were unsuccesful. 
Defaults to False.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>kegg_viaRC (bool, optional): Option to search for KEGG pathway ID using the </dt><dd><p>reaction class if previous searches were unsuccesful. 
Defaults to False.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>memote (bool, optional): Optionally run memote after the annotation. </dt><dd><p>Defaults to False.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-specimen.core.refinement.cleanup">
<span id="specimen-core-refinement-cleanup-module"></span><h2>specimen.core.refinement.cleanup module<a class="headerlink" href="#module-specimen.core.refinement.cleanup" title="Link to this heading"></a></h2>
<p>Perform part 3 of the refinement: clean-up.</p>
<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.cleanup.check_direction">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.cleanup.</span></span><span class="sig-name descname"><span class="pre">check_direction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Model</span></span></span><a class="headerlink" href="#specimen.core.refinement.cleanup.check_direction" title="Link to this definition"></a></dt>
<dd><p>Check the direction of newly created reactions (01-extention) by searching for matching MetaCyc,
KEGG and MetaNetX IDs as well as EC number in a downloaded BioCyc (MetaCyc)
database table (need to contain at least the following columns:
Reactions (MetaCyc ID),EC-Number,KEGG reaction,METANETX,Reaction-Direction.</p>
<p>&#64;NOTE: checks only creations that do not contain the notes[‘creation’] == ‘via template’</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>model (cobra.Model): The GEM containing the reactions to be check for direction.</p></li>
<li><p>data_file (str): Path to the MetabCyc (BioCyc) smart table.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>cobra.Model: The updated model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.cleanup.cobra_gapfill_wrapper">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.cleanup.</span></span><span class="sig-name descname"><span class="pre">cobra_gapfill_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">universal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medium</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Medium</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'BiGG'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'BiGG'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">growth_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Model</span></span></span><a class="headerlink" href="#specimen.core.refinement.cleanup.cobra_gapfill_wrapper" title="Link to this definition"></a></dt>
<dd><p>Wrapper for single_cobra_gapfill().</p>
<p>Either use the full set of reactions in universal model by setting iteration to
0 or None or use them in randomized chunks for faster runtime (especially useful
on laptops). Note: when using the second option, be aware that this does not
test all reaction combinations exhaustively (heuristic approach!!!).</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>model (cobra.Model): The model to perform gapfilling on.</p></li>
<li><p>universal (cobra.Model):  A model with reactions to be potentially used for the gapfilling.</p></li>
<li><p>medium (Medium): A medium the model should grow on.</p></li>
<li><dl class="simple">
<dt>namespace (Literal[‘BiGG’], optional): Namespace to use for the model. </dt><dd><p>Options include ‘BiGG’.
Defaults to ‘BiGG’.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>growth_threshold (float, optional): Growth threshold for the gapfilling. </dt><dd><p>Defaults to 0.05.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>iterations (int, optional): Number of iterations for the heuristic version of the gapfilling.</dt><dd><p>If 0 or None is given, uses full set of reactions.
Defaults to 3.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>chunk_size (int, optional): Number of reactions to be used for gapfilling at the same time. </dt><dd><p>If None or 0 is given, use full set, not heuristic.
Defaults to 10000.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>cobra.Model: The gapfilled model, if a solution was found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.cleanup.multiple_cobra_gapfill">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.cleanup.</span></span><span class="sig-name descname"><span class="pre">multiple_cobra_gapfill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">universal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">media_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Medium</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'BiGG'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'BiGG'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">growth_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Model</span></span></span><a class="headerlink" href="#specimen.core.refinement.cleanup.multiple_cobra_gapfill" title="Link to this definition"></a></dt>
<dd><p>Perform single_cobra_gapfill() on a list of media.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>model (cobra.Model): The model to be gapfilled.</p></li>
<li><p>universal (cobra.Model): The model to use reactions for gapfilling from.</p></li>
<li><p>media_list (list[Medium]): List ofmedia the model is supposed to grow on.</p></li>
<li><dl class="simple">
<dt>growth_threshold (float, optional): Growth threshold for the gapfilling. </dt><dd><p>Defaults to 0.05.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>iterations (int, optional): Number of iterations for the heuristic version of the gapfilling.</dt><dd><p>If 0 or None is given, uses full set of reactions.
Defaults to 3.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>chunk_size (int, optional): Number of reactions to be used for gapfilling at the same time. </dt><dd><p>If None or 0 is given, use full set, not heuristic.
Defaults to 10000.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>cobra.Model: The gapfilled model, if a solution was found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.cleanup.run">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.cleanup.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biocyc_db</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_dupl_reac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_dupl_meta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_unused_meta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_dupl_reac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_dupl_meta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">universal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">media_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'BiGG'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'BiGG'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">growth_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memote</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specimen.core.refinement.cleanup.run" title="Link to this definition"></a></dt>
<dd><p>Perform the second refinement step, cleanup, on a model.</p>
<p>The second refinement step resolves the following issues:
(1) (optional) checking direction of reactions with BioCyc
(2) resolve BioCyc/MetaCyc annotation inconsistencies
(3) find and/or resolve duplicates (reactions and metabolites)
(4) gapfilling using cobra + universal model with reactions + a set of media (&#64;TODO: under developement)</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>model (str): The Path to an sbml model.</p></li>
<li><p>dir (str): Path to the directory of the output.</p></li>
<li><dl class="simple">
<dt>biocyc_db (str, optional): Path to the BioCyc/MetaCyc reaction database file. </dt><dd><p>Defaults to None, which leads to skipping the direction check.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>check_dupl_reac (bool, optional): Option to check for duplicate reactions. </dt><dd><p>Defaults to False.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>check_dupl_meta (bool, optional): Option to check for duplicate metabolites. </dt><dd><p>Defaults to ‘default’, which checks based on MetaNetX first.
Further options include ‘skip’ and ‘exhaustive’ (check for all possibilities).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>remove_unused_meta (bool, optional): Option to remove unused metabolites from the model. </dt><dd><p>Defaults to False.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>remove_dupl_reac (bool, optional): Option to remove the duplicate reactions. </dt><dd><p>True is only applied, if check_dupl_reac is also True.
Defaults to False.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>remove_dupl_meta (bool, optional): Option to remove the duplicate metabolites. </dt><dd><p>True is only applied, if check_dupl_meta is also True.
Defaults to False.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>universal (str, optional): Path to a universal model for gapfilling. </dt><dd><p>Defaults to None, which skips the gapfilling.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>media_path (str, optional): Path to a medium config file for gapfilling. </dt><dd><p>Defaults to None.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>namespace (Literal[‘BiGG’], optional): Namespace to use for the model. </dt><dd><p>Options include ‘BiGG’.
Defaults to ‘BiGG’.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>growth_threshold (float, optional): Growth threshold for the gapfilling. </dt><dd><p>Defaults to 0.05.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>iterations (int, optional): Number of iterations for the heuristic version of the gapfilling.</dt><dd><p>If 0 or None is given, uses full set of reactions.
Defaults to 3.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>chunk_size (int, optional): Number of reactions to be used for gapfilling at the same time. </dt><dd><p>If None or 0 is given, use full set, not heuristic.
Defaults to 10000.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>memote (bool, optional): Option to run memote on the cleaned model. </dt><dd><p>Defaults to False.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Raises:</dt><dd><p>ValueError: Unknown option for check_dupl_meta</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.cleanup.single_cobra_gapfill">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.cleanup.</span></span><span class="sig-name descname"><span class="pre">single_cobra_gapfill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">universal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medium</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Medium</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'BiGG'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'BiGG'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">growth_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></span></span><a class="headerlink" href="#specimen.core.refinement.cleanup.single_cobra_gapfill" title="Link to this definition"></a></dt>
<dd><p>Attempt gapfilling (with COBRApy) for a given model to allow growth on a given
medium.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>model (cobra.Model): The model to perform gapfilling on.</p></li>
<li><p>universal (cobra.Model):  A model with reactions to be potentially used for the gapfilling.</p></li>
<li><p>medium (Medium): A medium the model should grow on.</p></li>
<li><dl class="simple">
<dt>namespace (Literal[‘BiGG’], optional): Namespace to use for the model. </dt><dd><p>Defaults to ‘BiGG’.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>growth_threshold (float, optional):  Minimal rate for the model to be considered growing.</dt><dd><p>Defaults to 0.05.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>Union[list[str],True]: List of reactions to be added to the model to allow growth
or True, if the model already grows.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-specimen.core.refinement.extension">
<span id="specimen-core-refinement-extension-module"></span><h2>specimen.core.refinement.extension module<a class="headerlink" href="#module-specimen.core.refinement.extension" title="Link to this heading"></a></h2>
<p>Part one of the third step of the pipeline: refinement - extension.</p>
<p>Extents the model by mapping missing genes to reactions via NCBI, KEGG,
MetaNetX and BiGG.</p>
<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.add_gene">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">add_gene</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reaction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Model</span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.add_gene" title="Link to this definition"></a></dt>
<dd><p>Add a new gene to a genome-scale metabolic cobra model.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>model (cobra.Model): The model.</p></li>
<li><p>reaction (str): The reaction id to add the gene to.</p></li>
<li><p>row (pd.Series): A single row of the output table of map_BiGG_reactions().</p></li>
<li><dl class="simple">
<dt>first (bool, optional):  Shows, if gene is the first gene to be added to the reaction. </dt><dd><p>True if gene is first to be added.
Defaults to False.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>cobra.Model: Updated model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.add_reaction">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">add_reaction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reac_xref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reac_prop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chem_xref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chem_prop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bigg_metabolites</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'BiGG'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_dna</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_rna</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Model</span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.add_reaction" title="Link to this definition"></a></dt>
<dd><p>Helper function for extent_model. For a given row of a gene to be added, add the 
corresponding reactions and metabolites via MetaNetX/KEGG as needed and available.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>model (cobra.Model): The model.</p></li>
<li><p>row (pd.Series): A row from the table in function extend_model.</p></li>
<li><p>reac_xref (pd.DataFrame): The MetaNetX reac_xref table.</p></li>
<li><p>reac_prop (pd.DataFrame): The MetaNetX reac_prop table.</p></li>
<li><p>chem_xref (pd.DataFrame): The MetaNetX chem_xref table.</p></li>
<li><p>chem_prop (pd.DataFrame): The MetaNetX chem_prop table.</p></li>
<li><p>bigg_metabolites (pd.DataFrame): The BiGG compound namespace table.</p></li>
<li><dl class="simple">
<dt>namespace (str, optional): Namespace of the model. </dt><dd><p>Defaults to ‘BiGG’.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>exclude_dna (bool, optional): Flag to exclude the addition of </dt><dd><p>directly DNA-related reactions. 
Defaults to True.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>exclude_rna (bool, optional): Flag to exclude the addition of </dt><dd><p>directly RNA-related reactions. 
Defaults to True.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>cobra.Model: The extended model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.build_metabolite_kegg">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">build_metabolite_kegg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kegg_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kegg_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bigg_metabolites</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'BiGG'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'BiGG'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Metabolite</span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.build_metabolite_kegg" title="Link to this definition"></a></dt>
<dd><p>Create or retrieve (from model) a metabolite based on its KEGG ID.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>kegg_id (str): The KEGG.compound ID of the metabolite in question.</p></li>
<li><p>model (cobra.Model): The model.</p></li>
<li><p>model_kegg_ids (list[str]): List of all annotated KEGG Compound IDs in the model.</p></li>
<li><p>bigg_metabolites (pd.DataFrame):  The BiGG compound namespace table.</p></li>
<li><p>namespace (Literal['BiGG'], optional): Namespace of the model. Defaults to ‘BiGG’.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>cobra.Metabolite:  The retrieved or newly build metabolite.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.build_metabolite_mnx">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">build_metabolite_mnx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metabolite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mnx_chem_prop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mnx_chem_xref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bigg_metabolites</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Metabolite</span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.build_metabolite_mnx" title="Link to this definition"></a></dt>
<dd><p>Create or retrieve (from model) a metabolite based on its MetaNetX ID.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>metabolite (str): The MetaNetX ID of the metabolite.</p></li>
<li><p>model (cobra.Model):  The underlying genome-scale metabolic model.</p></li>
<li><p>mnx_chem_prop (pd.DataFrame): The chem_xref table from MetaNetX.</p></li>
<li><p>mnx_chem_xref (pd.DataFrame): The chem_prop table from MetaNetX.</p></li>
<li><p>bigg_metabolites (pd.DataFrame): The BiGG compound namespace table.</p></li>
<li><p>namespace (pd.DataFrame): The namespace of the model.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>cobra.Metabolite: The retrieved or newly build metabolite.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.extent_model">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">extent_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chem_prop_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chem_xref_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reac_prop_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reac_xref_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'BiGG'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_dna</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_rna</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Model</span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.extent_model" title="Link to this definition"></a></dt>
<dd><p>Add reactions, metabolites and genes to a model based on the output of map_to_bigg().</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>table (pd.DataFrame): The table with the information to be added to the model.</dt><dd><p>Output of <code class="xref py py-func docutils literal notranslate"><span class="pre">map_to_bigg()</span></code>.</p>
</dd>
</dl>
</li>
<li><p>model (cobra.Model): The model to extend.</p></li>
<li><p>chem_prop_file (str): Path to the MetaNetX chem_prop file.</p></li>
<li><p>chem_xref_file (str): Path to the MetaNetX chem_xref file.</p></li>
<li><p>reac_prop_file (str): Path to the MetaNetX reac_prop file.</p></li>
<li><p>reac_xref_file (str): Path to the MetaNetX reac_xref file.</p></li>
<li><dl class="simple">
<dt>namespace (str, optional): Namespace of the model. </dt><dd><p>Defaults to ‘BiGG’.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>exclude_dna (bool, optional): Tag to include or exclude DNA reactions. </dt><dd><p>Defaults to True.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>exclude_rna (bool, optional): Tag to include or exclude RNA reactions. </dt><dd><p>Defaults to True.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>cobra.Model: The extended model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.find_best_diamond_hits">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">find_best_diamond_hits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.find_best_diamond_hits" title="Link to this definition"></a></dt>
<dd><p>Identify the best hits from the DIAMOND run.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>file (str): File name (path) of the “missing_genes” file.</p></li>
<li><dl class="simple">
<dt>pid (float): Threshold value for the PID. </dt><dd><p>Should be between 0.0 and 100.0 (given in percentage)</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>pd.DataFrame: Table of the locus tags of the query and the NCBI accession version numbers of the RefSeqs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.get_metabolites_kegg">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">get_metabolites_kegg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chem_xref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chem_prop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bigg_metabolites</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'BiGG'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'BiGG'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Metabolite</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.get_metabolites_kegg" title="Link to this definition"></a></dt>
<dd><p>Based on a given KEGG equation and a model, get or
create metabolite entires in/for the model.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>model (cobra.Model): A GEM.</p></li>
<li><p>equation (str): The equation from KEGG.</p></li>
<li><p>chem_xref (pd.DataFrame): The chem_xref table from MetaNetX.</p></li>
<li><p>chem_prop (pd.DataFrame): The chem_prop table from MetaNetX.</p></li>
<li><p>bigg_metabolites (pd.DataFrame): The BiGG compound namespace table.</p></li>
<li><dl class="simple">
<dt>namespace (Literal[‘BiGG’], optional): The namespace of the model. </dt><dd><p>Defaults to ‘BiGG’.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>dict[cobra.Metabolite,int]: Dictonary of metabolites and stoichiometric factors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.get_metabolites_mnx">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">get_metabolites_mnx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mnx_chem_xref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mnx_chem_prop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bigg_metabolites</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'BiGG'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'BiGG'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Metabolite</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.get_metabolites_mnx" title="Link to this definition"></a></dt>
<dd><p>Based on a given MetaNetX equation and a model, get or
create metabolite entires in/for the model.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>model (cobra.Model): The GEM.</p></li>
<li><p>equation (str): The equation from MetaNetX.</p></li>
<li><p>mnx_chem_xref (pd.DataFrame):  The chem_xref table from MetaNetX.</p></li>
<li><p>mnx_chem_prop (pd.DataFrame):  The chem_prop table from MetaNetX.</p></li>
<li><p>bigg_metabolites (pd.DataFrame): The BiGG compound namespace table.</p></li>
<li><dl class="simple">
<dt>namespace (Literal[‘BiGG’], optional): Namespace of the model. </dt><dd><p>Defaults to ‘BiGG’.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>dict[cobra.Metabolite,int]: Dictonary of metabolites and stoichiometric factors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.get_ncbi_info">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">get_ncbi_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncbi_map_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.get_ncbi_info" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Retrieve information from NCBI via mapping to precomputed files.</dt><dd><p>If no mapping exists, try via Entrez - implemented, but does not work well
-&gt; problems with connecting successfully to NCBI.
&#64;TODO if time, rewrite using the Bioppython package, see if it works better</p>
</dd>
<dt>Args:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>table (pd.DataFrame):  A table containing the output of “find_best_diamond_hits”.</dt><dd><p>Must have the column ‘ncbi_accession_version’.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ncbi_map_file (str, optional): A csv file containing the ncbi mapping. </dt><dd><p>Defaults to None.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>pd.DataFrame:  A table with the added information.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.identify_missing_genes">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">identify_missing_genes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fasta_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.identify_missing_genes" title="Link to this definition"></a></dt>
<dd><p>Identify missing genes in a model based on the draft model and a list of genes.
Save the missing genes’ sequences in a new FASTA file.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>gene_path (str): Path to the csv file containing the list of genes.</p></li>
<li><p>model (cobra.Model): The draft model.</p></li>
<li><p>id (str): Name of the column in gene_path, that equal the ids in the model.</p></li>
<li><p>fasta_path (str): Path to the FASTA file containing all genes for the genome.</p></li>
<li><p>dir (str): Path to the directory to save the new FASTA in.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>pd.DataFrame:  A table with the missing genes’ information.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.isreaction_complete">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">isreaction_complete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Reaction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_dna</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_rna</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.isreaction_complete" title="Link to this definition"></a></dt>
<dd><p>Check, if a reaction is complete and ready to be added to the model.
Additionally, it is possible to check for DNA and RNA reations
and set them to be excluded or included.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>reac (cobra.Reaction): The reaction to be checked.</p></li>
<li><dl class="simple">
<dt>exclude_dna (bool, optional): Tag to include or exclude DNA reactions. </dt><dd><p>Defaults to True.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>exclude_rna (bool, optional): Tag to include or exclude RNA reactions. </dt><dd><p>Defaults to True.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>bool: True if the check is successful, else false.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.map_BiGG_reactions">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">map_BiGG_reactions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.map_BiGG_reactions" title="Link to this definition"></a></dt>
<dd><p>Map the output of map_to_KEGG() to a BiGG namespace file (rewritten-type, see auxilliaries).</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>table_file (str): The path to the saved table from running map_to_KEGG().</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>pd.DataFrame: The table with an additional column for the mapping to BiGG reactions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.map_BiGG_reactions_row">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">map_BiGG_reactions_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.map_BiGG_reactions_row" title="Link to this definition"></a></dt>
<dd><p>Map a single entry from the table in map_BiGG_reactions() to the BiGG reaction namespace.</p>
<dl class="simple">
<dt>&#64;TODO</dt><dd><dl class="simple">
<dt>NOTE: only works for cases, where KEGG.reaction in row contains EXACTLY one entry</dt><dd><p>in the rare case that multiple reactions belong to one enzyme, they are omitted
in this search</p>
</dd>
</dl>
</dd>
<dt>Args:</dt><dd><ul class="simple">
<li><p>row (pd.Series): A single row of the table.</p></li>
<li><p>namespace (pd.DataFrame): The BiGG reaction namespace table.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>pd.Series:  The edited row.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.map_to_KEGG">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">map_to_KEGG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manual_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genome_summary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Path</span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.map_to_KEGG" title="Link to this definition"></a></dt>
<dd><p>Map entries of the table from get_ncbi_info() to KEGG.
Get KEGG.reaction ID from locus tag, if available, otherwise try EC number.
Entries of the finalised table are saved depending whether they were assigned
a KEGG.reaction ID (further use) or not (possible starting point for manual curation).</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>gene_table (pd.DataFrame): The input table containing the output of get_ncbi_info().</p></li>
<li><p>working_dir (str): Path to the working directory - place to save genes with a KEGG.reaction ID.</p></li>
<li><p>manual_dir (str): Path to a directory to save the genes without KEGG assignment for possible manual curation.</p></li>
<li><dl class="simple">
<dt>genome_summary (str, optional):  Path to a information file for the reference genomes to check if they are in KEGG. </dt><dd><p>Defaults to None.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>Path: The path to the file containing the genes with KEGG assignment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.map_to_KEGG_row">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">map_to_KEGG_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loci_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.map_to_KEGG_row" title="Link to this definition"></a></dt>
<dd><p>Map a single entry of the table in map_to_KEGG() to KEGG.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>row (pd.Series): A single row of the table.</p></li>
<li><dl class="simple">
<dt>loci_list (list[str], optional): List of starting letters of locus tags belong to organisms, that are listed in KEGG</dt><dd><p>and the corresponding organism three-letter code. 
Defaults to None (= search all entries).</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>pd.Series: The mapped row.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.map_to_NCBI_efetch_row">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">map_to_NCBI_efetch_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#specimen.core.refinement.extension.map_to_NCBI_efetch_row" title="Link to this definition"></a></dt>
<dd><p>Map a single entry from the table in get_ncbi_info() to NCBI using EntrezDirect.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>row (pd.Series): A single row of the table.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>pd.Series: The edited row.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.extension.run">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.extension.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">draft</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fasta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mnx_chem_prop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mnx_chem_xref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mnx_reac_prop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mnx_reac_xref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncbi_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncbi_dat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'locus_tag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'sensitive'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'more-sensitive'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'very-sensitive'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'ultra-sensitive'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'more-sensitive'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coverage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">95.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">90.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_dna</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_rna</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memote</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specimen.core.refinement.extension.run" title="Link to this definition"></a></dt>
<dd><p>Extend a draft model.</p>
<p>Using a multitude of information from MetaNetX, KEGG, NCBI and more,
extend a draft model by yet unadded genes (“missing genes”) by mapping them against
a database using DIAMOND.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>draft (str): Path to the draft model.</p></li>
<li><p>gene_list (str): Path to a csv file containing information on all the genes found in the annotated genome.</p></li>
<li><p>fasta (str): Path to the (protein) FASTA file containing the CDS sequences.</p></li>
<li><p>db (str): Path to the database used for running DIAMOND.</p></li>
<li><p>dir (str):  Path to the directory for the output (directories).</p></li>
<li><p>mnx_chem_prop (str): Path to the MetaNetX chem_prop namespace file.</p></li>
<li><p>mnx_chem_xref (str): Path to the MetaNetX chem_xref namespace file.</p></li>
<li><p>mnx_reac_prop (str): Path to the MetaNetX reac_prop namespace file.</p></li>
<li><p>mnx_reac_xref (str): Path to the MetaNetX reac_xref namespace file.</p></li>
<li><p>ncbi_map (str): Path to the ncbi information mapping file. Optional, but recommended.</p></li>
<li><p>ncbi_dat (str): Path to the ncbi database information file. Optional, but recommended.</p></li>
<li><dl class="simple">
<dt>id (str, optional): Name of the column of the csv file that contains the entries that were </dt><dd><p>used as gene identifiers in the draft model. 
Defaults to ‘locus_tag’.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>sensitivity (Literal[‘sensitive’, ‘more-sensitive’, ‘very-sensitive’,’ultra-sensitive’], optional): Sensitivity mode for DIAMOND blastp run.</dt><dd><p>Can be sensitive, more-sensitive, very-sensitive or ultra-sensitive.
Defaults to ‘more-sensitive’.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>coverage (float, optional): Threshold value for the query coverage for DIAMOND. </dt><dd><p>Defaults to 95.0.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>pid (float, optional): PID (percentage identity value) to filter the blast hist by. </dt><dd><p>Only hits equal or above the given value are kept.
Defaults to 90.0.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>threads (int, optional): Number of threads to be used for DIAMOND. </dt><dd><p>Defaults to 2.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>exclude_dna (bool, optional): Exclude reactions with DNA in their name when added. </dt><dd><p>Defaults to True.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>exclude_rna (bool, optional): Exclude reactions with RNA in their name when added. </dt><dd><p>Defaults to True.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>memote (bool, optional): Use memote on the extended model. </dt><dd><p>Defaults to False.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Raises:</dt><dd><p>ValueError: Unknown sensitivity mode.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-specimen.core.refinement.smoothing">
<span id="specimen-core-refinement-smoothing-module"></span><h2>specimen.core.refinement.smoothing module<a class="headerlink" href="#module-specimen.core.refinement.smoothing" title="Link to this heading"></a></h2>
<p>Perform part 4 of the refinement: smoothing.</p>
<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.smoothing.adjust_BOF">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.smoothing.</span></span><span class="sig-name descname"><span class="pre">adjust_BOF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">genome</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dna_weight_fraction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_frac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#specimen.core.refinement.smoothing.adjust_BOF" title="Link to this definition"></a></dt>
<dd><p>Adjust the model’s BOF using BOFdat. Currently implemented are step 1
DNA coefficients and step 2.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>genome (str): Path to the genome (e.g. .fna) FASTA file.</p></li>
<li><p>model_file (str): Path to the sbml (.xml) file of the model.</p></li>
<li><p>model (cobra.Model): The genome-scale metabolic model (from the string above), loaded with COBRApy.</p></li>
<li><p>dna_weight_fraction (float): DNA weight fraction for BOF step 1.</p></li>
<li><p>weight_frac (float): Weight fraction for the second step of BOFdat (enzymes and ions)</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>str: The updated BOF reaction as a reaction string.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.smoothing.perform_mcc">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.smoothing.</span></span><span class="sig-name descname"><span class="pre">perform_mcc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Model</span></span></span><a class="headerlink" href="#specimen.core.refinement.smoothing.perform_mcc" title="Link to this definition"></a></dt>
<dd><p>_summary_</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>model (cobra.Model): The model to use the tool on.</p></li>
<li><p>dir (str): Path of the directory to save MCC output in.</p></li>
<li><dl class="simple">
<dt>apply (bool, optional): If True, model is directly updated with the results. </dt><dd><p>Defaults to True.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>cobra.Model: The model (updated or not)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specimen.core.refinement.smoothing.run">
<span class="sig-prename descclassname"><span class="pre">specimen.core.refinement.smoothing.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">genome</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'skip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">egc_solver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'greedy'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'BiGG'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'BiGG'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dna_weight_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.023</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ion_weight_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memote</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specimen.core.refinement.smoothing.run" title="Link to this definition"></a></dt>
<dd><p>Perform the fourth step of the refinement, smoothing, on a model.</p>
<p>The fourth step of the refinment, smoothing, includes:
- Mass-Charge curation
- checking energy generating cycles
- adjusting Biomass objective function parameters based on genome</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>genome (str): Path to the genome FASTA (e.g. .fna) file of your genome.</p></li>
<li><p>model (str): Path to the model. Should be sbml-format.</p></li>
<li><p>dir (str): Path of the output directory.</p></li>
<li><dl class="simple">
<dt>mcc (str, optional): Option for the Mass-Charge curation.</dt><dd><p>Can be ‘skip’, ‘apply’ (directly use MCC on model) or ‘extra’ (only generate information). 
Defaults to ‘skip’.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>egc_solver (None | Literal[‘greedy’], optional): If given, uses the option to solve EGCs.</dt><dd><p>Current options include greedy (Greedy Solver).
Defaults to ‘greedy’.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>namespace (Literal[‘BiGG’], optional): Namespace to use for the model.</dt><dd><p>Defaults to ‘BiGG’.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>dna_weight_frac (float, optional):  DNA weight fraction to use for BOFdat.</dt><dd><p>Default is 0.023 for Klebsiella pneumoniae based on Liao et al.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ion_weight_frac (float, optional): Ion weight fraction to use for BOFdat.</dt><dd><p>Defaults to 0.05.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>memote (bool, optional): Option to run memote after the refinement.</dt><dd><p>Defaults to False.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-specimen.core.refinement">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-specimen.core.refinement" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="specimen.core.html" class="btn btn-neutral float-left" title="specimen.core package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="specimen.util.html" class="btn btn-neutral float-right" title="specimen.util package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Carolin Brune.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>